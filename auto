offer-comparison/
 ├── pom.xml :<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.example</groupId>
    <artifactId>offer-comparison</artifactId>
    <version>1.0</version>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
    </parent>

    <dependencies>

        <!-- Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- Thymeleaf -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
        </dependency>

        <!-- PDF generation -->
        <dependency>
            <groupId>org.apache.pdfbox</groupId>
            <artifactId>pdfbox</artifactId>
            <version>2.0.29</version>
        </dependency>

        <!-- File upload -->
        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.13.0</version>
        </dependency>

        <!-- Excel handling -->
        <dependency>
            <groupId>org.apache.poi</groupId>
            <artifactId>poi-ooxml</artifactId>
            <version>5.2.5</version>
        </dependency>

        <!-- Database -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>runtime</scope>
        </dependency>

    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

</project>

 ├── src/
 │   ├── main/
 │   │   ├── java/
 │   │   │   └── com/example/offers/
 │   │   │       ├── OfferComparisonApplication.java:package com.example.offers;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class OfferComparisonApplication {
    public static void main(String[] args) {
        SpringApplication.run(OfferComparisonApplication.class, args);
    }
}

 │   │   │       ├── controller/
 │   │   │       │     └── FileController.java:package com.example.offers.controller;

import com.example.offers.repository.VendorRepository;
import com.example.offers.service.FileProcessingService;
import com.example.offers.service.PdfGeneratorService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.multipart.MultipartFile;

import jakarta.servlet.http.HttpServletResponse;

@Controller
public class FileController {

    @Autowired
    FileProcessingService fileService;

    @Autowired
    PdfGeneratorService pdfService;

    @Autowired
    VendorRepository vendorRepository;

    @GetMapping("/")
    public String home() {
        return "index";
    }

    @PostMapping("/upload")
    public String uploadFiles(@RequestParam("files") MultipartFile[] files, Model model) throws Exception {

        StringBuilder all = new StringBuilder();

        for (MultipartFile f : files) {
            if (f.getOriginalFilename().endsWith(".pdf")) {
                all.append(fileService.extractTextFromPdf(f.getInputStream()));
            } else if (f.getOriginalFilename().endsWith(".xlsx")) {
                all.append(fileService.extractTextFromExcel(f.getInputStream()));
            }
        }

        model.addAttribute("text", all.toString());
        return "comparison";
    }

    @PostMapping("/download")
    public void downloadPdf(@RequestParam("text") String text,
                            HttpServletResponse response) throws Exception {

        byte[] pdf = pdfService.generateComparisonPdf(text);

        response.setContentType("application/pdf");
        response.setHeader("Content-Disposition", "attachment; filename=comparison.pdf");
        response.getOutputStream().write(pdf);
    }
}

 │   │   │       ├── model/
 │   │   │       │     └── Vendor.java:package com.example.offers.model;

import jakarta.persistence.Entity;
import jakarta.persistence.Id;

@Entity
public class Vendor {

    @Id
    private String vendorCode;

    private String name;
    private String email;
    private String phone;

    public Vendor() {}

    public Vendor(String vendorCode, String name, String email, String phone) {
        this.vendorCode = vendorCode;
        this.name = name;
        this.email = email;
        this.phone = phone;
    }

    // getters + setters
}

 │   │   │       ├── service/
 │   │   │       │     ├── FileProcessingService.java:package com.example.offers.service;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.text.PDFTextStripper;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.springframework.stereotype.Service;

import java.io.InputStream;

@Service
public class FileProcessingService {

    public String extractTextFromPdf(InputStream input) throws Exception {
        PDDocument doc = PDDocument.load(input);
        PDFTextStripper stripper = new PDFTextStripper();
        String text = stripper.getText(doc);
        doc.close();
        return text;
    }

    public String extractTextFromExcel(InputStream input) throws Exception {
        Workbook wb = new XSSFWorkbook(input);
        Sheet sheet = wb.getSheetAt(0);
        StringBuilder sb = new StringBuilder();

        for (Row row : sheet) {
            for (Cell cell : row) {
                sb.append(cell.toString()).append(" | ");
            }
            sb.append("\n");
        }

        wb.close();
        return sb.toString();
    }
}

 │   │   │       │     └── PdfGeneratorService.java:package com.example.offers.service;

import org.apache.pdfbox.pdmodel.*;
import org.apache.pdfbox.pdmodel.font.PDType1Font;
import org.springframework.stereotype.Service;

import java.io.ByteArrayOutputStream;

@Service
public class PdfGeneratorService {

    public byte[] generateComparisonPdf(String comparisonText) throws Exception {

        PDDocument doc = new PDDocument();
        PDPage page = new PDPage();
        doc.addPage(page);

        PDPageContentStream cs = new PDPageContentStream(doc, page);
        cs.setFont(PDType1Font.HELVETICA, 12);

        cs.beginText();
        cs.newLineAtOffset(50, 700);
        cs.showText("Offer Comparison Report");
        cs.newLineAtOffset(0, -30);
        cs.showText(comparisonText);
        cs.endText();

        cs.close();

        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        doc.save(baos);
        doc.close();

        return baos.toByteArray();
    }
}

 │   │   │       └── repository/
 │   │   │             └── VendorRepository.java:package com.example.offers.repository;

import com.example.offers.model.Vendor;
import org.springframework.data.jpa.repository.JpaRepository;

public interface VendorRepository extends JpaRepository<Vendor, String> {
}

 │   │   ├── resources/
 │   │   │     ├── templates/
 │   │   │     │     ├── index.html:<!DOCTYPE html>
<html>
<head>
    <title>Offer Comparison</title>
    <style>
        body { background: linear-gradient(green, blue); color: white; font-family: Arial; }
        .box { background:white; color:black; padding:20px; margin:50px auto; width:50%; border-radius:10px; }
    </style>
</head>
<body>
<div class="box">
    <h2>Upload Offers</h2>
    <form action="/upload" method="post" enctype="multipart/form-data">
        <input type="file" name="files" multiple required>
        <button type="submit">Process</button>
    </form>
</div>
</body>
</html>

 │   │   │     │     ├── <!DOCTYPE html>
<html>
<head>
    <title>Comparison</title>
</head>
<body>
<h2>Generated Text</h2>

<form method="post" action="/download">
    <textarea name="text" rows="20" cols="100">{{text}}</textarea><br>
    <button type="submit">Download PDF</button>
</form>

</body>
</html>

 │   │   │     │     └── sourcing.html
 │   │   │     └── spring.datasource.url=jdbc:h2:mem:testdb
spring.jpa.hibernate.ddl-auto=create
spring.h2.console.enabled=true

 │   └── test/
